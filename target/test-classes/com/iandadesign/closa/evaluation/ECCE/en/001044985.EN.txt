Madrid's role in the financial crisis has the erratic quality of Dr Jekyll and Mr Hyde.
It has veered unpredictably between embodying the euro's greatest threat and pushing the reforms the monetary union badly needs.
It is vital that the deal on eurozone financial assistance for Spain's banks should be a step to a permanent solution and not a redoubling of past mistakes.
It is good that the agreement activates a new power granted to Europe's rescue funds last year.
Madrid will borrow money not for its main budget but for the Frob, its bank bailout fund.
The assistance will be limited to the banking system, without Spain entering a programme subject to the eurozone-International Monetary Fund troika.
This reward for genuine commitment to austerity and structural reform will hopefully prevent relations with Europe from becoming as poisoned as in some other countries.
The key dysfunction of the euro, however, is not addressed.
Rather than sever the lethal embrace between stressed sovereign debt and weak banking systems, a cash advance to bail out banks with taxpayer funds adds to the burden of Madrid's public finances.
If the state of Spanish banks is much worse than expected, this action could amount to lending the country rope with which to hang itself – repeating the Irish mistake.
Until this prospect is banished, markets will not regain confidence in Spain, despite the strengths of its corporate sector, its structural reforms and a speedy macroeconomic adjustment.
What is needed are bank resolution rules that cap taxpayer exposure.
This means writing down shareholders and converting uninsured and unsecured debt into equity when banks cannot raise the capital they need.
If it dares, Madrid can take steps in this direction. It should stick to the €99bn envelope for the Frob's investments – which means limiting the European credit line to the €80bn or so not already funded.
It should also instruct the Frob not to inject capital before shareholders and creditors take a hit.
That should make €80bn enough.
The political obstacles are formidable.
It would expose the political machinations behind banks that exploit public trust.
Bankia, for example, flogged its shares to its retail savers, who will lose in a writedown.
Also, Berlin is set against any losses for creditors as German savers and pensioners would be among them.
Governments understandably fear the ire of victims of reckless banks.
Protecting the banks themselves, however, only prolongs the problem.