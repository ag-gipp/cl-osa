The gruesome attack on Nairobi's Westgate shopping mall, which has claimed the lives of at least 59 people, has struck at the cosmopolitan heart of Kenya's urban renaissance. 
The mall is a melting pot of elite Kenyans and expatriates – western and Asian – whose convergence is driving a boom in consumption and commerce, as well as an upsurge in innovation.
The al-Qaeda linked extremists from Somalia who are claiming responsibility have calculated carefully to inflict maximum damage. 
The timing of the attack, the worst perpetrated by terrorists in Kenya since the 1998 US embassy bombings, seems designed to undermine optimism about the economy – which hinges partly on Kenya's status as a hub for tourism and trade.
The risk has always been that Islamist extremists from, or linked to, Somalia would hit back at soft targets in the region when squeezed by military pressure at home. 
This is especially the case since Kenya's army rolled into Somalia two years ago as part of regional efforts to quash the militants and help re-establish some semblance of a Somali state. 
Uganda experienced a similar horror in 2010.
This will do nothing to weaken the resolve of the Kenyan authorities to consolidate military control of border territory inside Somalia, and to root out extremist groups within Kenya itself. 
But the attacks provide a reminder of how hard it is to confront the threat. Islamist extremism in Africa from Kenya across to Mali and Nigeria is resilient in the face of conventional armies. 
The battle against it will be long.
This is a time for the world to stand behind Kenya and offer assistance to prevent repeat attacks. 
The circumstances are difficult, however. 
Western governments are already navigating uncharted diplomatic waters in their dealings with President Uhuru Kenyatta, who is due to stand trial at the International Criminal Court in The Hague next month for his alleged role in marshalling death squads following flawed 2008 polls.
Mr Kenyatta, who lost relatives in the attack, cut an assured figure at the weekend. 
In a rare show of solidarity, fellow politicians closed ranks. 
This seems sure to provide further ammunition to those in Kenya who are hostile to the prospect of a sitting head of state standing trial abroad. 
And it poses another challenge to those seeking to balance the sometimes conflicting imperatives of international justice and security.